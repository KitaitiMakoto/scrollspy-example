<!doctype html>
<meta charset=UTF-8>
<title>Scrollspy example</title>
<meta name=viewport content="width=device-width,initial-scale=1">
<link href=node_modules/sanitize.css/sanitize.css rel=stylesheet>
<link href=index.css rel=stylesheet>

<h1 id=top>Scrollspy example</h1>

<nav id=nav aria-expanded=false>
  <ul>
    <li><a href=#whatsthis>これは何？</a></li>
    <li><a href=#motivation>作った動機</a></li>
    <li><a href=#smoothscroll>CSSによるスムーススクロール</a></li>
    <li><a href=#sticky>CSSによる条件付き位置固定</a></li>
    <li><a href=#custom-property>CSS変数</a></li>
    <li><a href=#source-code>ソースコード</a></li>
  </ul>
  <button role=button tabindex=0 aria-controls=nav>▼</buttn>
</nav>

<section id=whatsthis>
  <h2>これは何？</h2>
  <p>モバイル用のスクロールスパイのサンプルです。</p>
  <p>スクロールスパイはよくサイドバーの目次として表示されますが、モバイルの場合は普通サイドバーを作らないので、スクロールスパイもあまり目にすることがありません。</p>
  <p>そこで、この例のように、上部固定で、内容が変わっていくという形ならば広く使えるのではないかと思い付いたので、その提案です。</p>
</section>
<section id=motivation>
  <h2>作った動機</h2>
  <p><a href="https://blog.jxck.io/entries/2016-06-25/intersection-observer.html">Intersection Observer を用いた要素出現検出の最適化</a>という記事に感激し、実際にIntersection Observerを使ってみたくなったので、題材としてスクロールスパイを選びました。</p>
</section>
<section id=smoothscroll>
  <h2>CSSのみによるスムーススクロール</h2>
  <p>CSSには<code>scroll-behavior</code>というプロパティがあり、</p>
  <pre><code>body {
    scroll-behavior: smooth;
}</code></pre>
  <p>と、<code>smooth</code>という値を指定することで、ブラウザーが自動的にスムーススクロールを実行してくれます。このページでもこの機能を使用しています。</p>
  <p><time datetime="2016-09">2016年9月</time>現在、（iOS以外の）Firefoxではこのプロパティが実装されているので、このページもFirefoxで見てみてください。</p>
  <p>参考：<a href="https://hyper-text.org/archives/2014/10/scroll-behavior-property-demo/">scroll-behavior: smooth; のデモ</a></p>
</section>
<section id=sticky>
  <h2>CSSのみによる条件付き位置固定（<code>position: sticky</code>）</h2>
  <p>スクロールスパイによるナビゲーションは、初めはページタイトルの下にあり、スクロールすると画面上部に固定されます。</p>
  <p>通常、この機能はJavaScriptとCSSの組み合わせで実装されますが、このページではCSSのみで実現しています。</p>
  <pre><code>nav {
    position: sticky;
    /*
      :
      :
    */
}</code></pre>
  <p>と、<code>position</code>プロパティに<code>sticky</code>を指定することで、こうした振る舞いになります。</p>
  <p><time datetime="2016-09">2016年9月</time>現在、FirefoxとSafariで実装されています。</p>
  <p>参考：<a href="http://unformedbuilding.com/articles/css-position-sticky/">素敵な position: sticky; | Unformed Building</a></p>
</section>
<section id=custom-property>
  <h2>CSSカスタムプロパティ（CSS変数）</h2>
  <p>目に見えないので実感はできませんが、スクロールスパイの高さは、CSSカスタムプロパティを使って設定しています。</p>
  <p>スクロールスパイ部分の高さと同じだけ、各セクションの上部に余白を作っていますが、これらを同じ一つの変数で管理することで、設定漏れがないようになっています。</p>
  <p>少し前まではFirefoxのみがCSSカスタムプロパティを実装していましたが、今では他にChrome、Safariでも使用することができます。</p>
  <p>参考：<a href="http://postd.cc/css-variables-why-should-you-care/">CSS Variables(カスタムプロパティ)： なぜ、関心を持つべきか？ | プログラミング | POSTD</a></p>
</section>
<section id=source-code>
  <h2>ソースコード</h2>
  <p>このページのソースコードは<a href="https://github.com">GitHub</a>にホストしてもらっています。</p>
  <p>ソースコード：<a href="https://github.com/KitaitiMakoto/scrollspy-example">KitaitiMakoto/scrollspy-example</a></p>
</section>
<p>&copy;<a href="https://github.com/KitaitiMakoto">北市真</a></p>
<script src=node_modules/intersection-observer/intersection-observer.js></script>
<script src=index.js></script>
